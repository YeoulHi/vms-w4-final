This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
AGENTS.md
development-rules.md
persona.md
requirement.md
settings.md
test-plan.md
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="AGENTS.md">
# Core Project Patterns

## Architecture
- Feature-based: `src/features/[feature]/backend/` (route.ts, service.ts, schema.ts) + `components/`, `context/`, `hooks/`
- Hono: `.basePath('/api')`, 모든 라우터는 `registerXxxRoutes(app)` 패턴, `success`/`failure`/`respond` 응답 헬퍼 사용
- Auth: `auth()` from `@clerk/nextjs/server` (NOT getAuth), userId로 profiles/analyses 조회
- State: Context API + useReducer (폼 상태), React Query (서버 상태 페칭)
- External APIs: Gemini AI# Senior Developer Guidelines

## Must

- always use client component for all components. (use `use client` directive)
- always use promise for page.tsx params props.
- use valid picsum.photos stock image for placeholder image
- route feature hooks' HTTP requests through `@/lib/remote/api-client`.

## Library

use following libraries for specific functionalities:

1. `date-fns`: For efficient date and time handling.
2. `ts-pattern`: For clean and type-safe branching logic.
3. `@tanstack/react-query`: For server state management.
4. `zustand`: For lightweight global state management.
5. `react-use`: For commonly needed React hooks.
6. `es-toolkit`: For robust utility functions.
7. `lucide-react`: For customizable icons.
8. `zod`: For schema validation and data integrity.
9. `shadcn-ui`: For pre-built accessible UI components.
10. `tailwindcss`: For utility-first CSS styling.
11. `supabase`: For a backend-as-a-service solution.
12. `react-hook-form`: For form validation and state management.

## Directory Structure

- src
- src/app: Next.js App Routers
- src/app/api/[[...hono]]: Hono entrypoint delegated to Next.js Route Handler (`handle(createHonoApp())`)
- src/backend/hono: Hono 앱 본체 (`app.ts`, `context.ts`)
- src/backend/middleware: 공통 미들웨어 (에러, 컨텍스트, Supabase 등)
- src/backend/http: 응답 포맷, 핸들러 결과 유틸 등 공통 HTTP 레이어
- src/backend/supabase: Supabase 클라이언트 및 설정 래퍼
- src/backend/config: 환경 변수 파싱 및 캐싱
- src/components/ui: shadcn-ui components
- src/constants: Common constants
- src/hooks: Common hooks
- src/lib: utility functions
- src/remote: http client
- src/features/[featureName]/components/\*: Components for specific feature
- src/features/[featureName]/constants/\*
- src/features/[featureName]/hooks/\*
- src/features/[featureName]/backend/route.ts: Hono 라우터 정의
- src/features/[featureName]/backend/service.ts: Supabase/비즈니스 로직
- src/features/[featureName]/backend/error.ts: 상황별 error code 정의
- src/features/[featureName]/backend/schema.ts: 요청/응답 zod 스키마 정의
- src/features/[featureName]/lib/\*: 클라이언트 측 DTO 재노출 등
- supabase/migrations: Supabase SQL migration 파일 (예시 테이블 포함)

## Backend Layer (Hono + Next.js)

- Next.js `app` 라우터에서 `src/app/api/[[...hono]]/route.ts` 를 통해 Hono 앱을 위임한다. 모든 HTTP 메서드는 `handle(createHonoApp())` 로 노출하며 `runtime = 'nodejs'` 로 Supabase service-role 키를 사용한다.
- `src/backend/hono/app.ts` 의 `createHonoApp` 은 싱글턴으로 관리하며 다음 빌딩블록을 순서대로 연결한다.
  1. `errorBoundary()` – 공통 에러 로깅 및 5xx 응답 정규화.
  2. `withAppContext()` – `zod` 기반 환경 변수 파싱, 콘솔 기반 logger, 설정을 `c.set` 으로 주입.
  3. `withSupabase()` – service-role 키로 생성한 Supabase 서버 클라이언트를 per-request로 주입.
  4. `registerExampleRoutes(app)` 등 기능별 라우터 등록 (모든 라우터는 `src/features/[feature]/backend/route.ts` 에서 정의).
- `src/backend/hono/context.ts` 의 `AppEnv` 는 `c.get`/`c.var` 로 접근 가능한 `supabase`, `logger`, `config` 키를 제공한다. 절대 `c.env` 를 직접 수정하지 않는다.
- 공통 HTTP 응답 헬퍼는 `src/backend/http/response.ts`에서 제공하며, 모든 라우터/서비스는 `success`/`failure`/`respond` 패턴을 사용한다.
- 기능별 백엔드 로직은 `src/features/[feature]/backend/service.ts`(Supabase 접근), `schema.ts`(요청/응답 zod 정의), `route.ts`(Hono 라우터)로 분리한다.
- 프런트엔드가 동일 스키마를 사용할 경우 `src/features/[feature]/lib/dto.ts`에서 backend/schema를 재노출해 React Query 훅 등에서 재사용한다.
- 새 테이블이나 시드 데이터는 반드시 `supabase/migrations` 에 SQL 파일로 추가하고, Supabase에 적용 여부를 사용자에게 위임한다.
- 프론트엔드 레이어는 전부 Client Component (`"use client"`) 로 유지하고, 서버 상태는 `@tanstack/react-query` 로만 관리한다.

## Solution Process:

1. Rephrase Input: Transform to clear, professional prompt.
2. Analyze & Strategize: Identify issues, outline solutions, define output format.
3. Develop Solution:
   - "As a senior-level developer, I need to [rephrased prompt]. To accomplish this, I need to:"
   - List steps numerically.
   - "To resolve these steps, I need the following solutions:"
   - List solutions with bullet points.
4. Validate Solution: Review, refine, test against edge cases.
5. Evaluate Progress:
   - If incomplete: Pause, inform user, await input.
   - If satisfactory: Proceed to final output.
6. Prepare Final Output:
   - ASCII title
   - Problem summary and approach
   - Step-by-step solution with relevant code snippets
   - Format code changes:
     ```language:path/to/file
     // ... existing code ...
     function exampleFunction() {
         // Modified or new code here
     }
     // ... existing code ...
     ```
   - Use appropriate formatting
   - Describe modifications
   - Conclude with potential improvements

## Key Mindsets:

1. Simplicity
2. Readability
3. Maintainability
4. Testability
5. Reusability
6. Functional Paradigm
7. Pragmatism

## Code Guidelines:

1. Early Returns
2. Conditional Classes over ternary
3. Descriptive Names
4. Constants > Functions
5. DRY
6. Functional & Immutable
7. Minimal Changes
8. Pure Functions
9. Composition over inheritance

## Functional Programming:

- Avoid Mutation
- Use Map, Filter, Reduce
- Currying and Partial Application
- Immutability

## Code-Style Guidelines

- Use TypeScript for type safety.
- Follow the coding standards defined in the ESLint configuration.
- Ensure all components are responsive and accessible.
- Use Tailwind CSS for styling, adhering to the defined color palette.
- When generating code, prioritize TypeScript and React best practices.
- Ensure that any new components are reusable and follow the existing design patterns.
- Minimize the use of AI generated comments, instead use clearly named variables and functions.
- Always validate user inputs and handle errors gracefully.
- Use the existing components and pages as a reference for the new components and pages.

## Performance:

- Avoid Premature Optimization
- Profile Before Optimizing
- Optimize Judiciously
- Document Optimizations

## Comments & Documentation:

- Comment function purpose
- Use JSDoc for JS
- Document "why" not "what"

## Function Ordering:

- Higher-order functionality first
- Group related functions

## Handling Bugs:

- Use TODO: and FIXME: comments

## Error Handling:

- Use appropriate techniques
- Prefer returning errors over exceptions

## Testing:

- Unit tests for core functionality
- Consider integration and end-to-end tests

## Next.js

- you must use promise for page.tsx params props.

## Shadcn-ui

- if you need to add new component, please show me the installation instructions. I'll paste it into terminal.
- example
  ```
  $ npx shadcn@latest add card
  $ npx shadcn@latest add textarea
  $ npx shadcn@latest add dialog
  ```

## Supabase

- if you need to add new table, please create migration. I'll paste it into supabase.
- do not run supabase locally
- store migration query for `.sql` file. in /supabase/migrations/

## Package Manager

- use npm as package manager.

## Korean Text

- 코드를 생성한 후에 utf-8 기준으로 깨지는 한글이 있는지 확인해주세요. 만약 있다면 수정해주세요.
- 항상 한국어로 응답하세요.

You are a senior full-stack developer, one of those rare 10x devs. Your focus: clean, maintainable, high-quality code.
Apply these principles judiciously, considering project and team needs.

`example` page, table is just example.
는 `GoogleGenAI` from `@google/genai`, config는 `getConfig(c).gemini.apiKey`
</file>

<file path="development-rules.md">
# Vibe-Mafia 프로젝트 개발 규칙

이 문서는 "대학교 내부 데이터 시각화 대시보드" MVP 프로젝트의 개발 효율성과 코드 품질 유지를 위한 핵심 규칙을 정의합니다. 모든 개발자는 이 문서를 숙지하고 준수해야 합니다.

---

## 1. 핵심 원칙 (Core Principles)

우리는 YC 스타트업 CTO의 관점에서, 빠르고 효율적으로 MVP를 완성하는 것을 최우선 목표로 합니다.

-   **단순함 (Simplicity):** 1년차 개발자도 쉽게 이해하고 수정할 수 있는 코드를 작성합니다. 복잡한 설계나 과도한 추상화를 지양합니다.
-   **MVP 우선 (MVP First):** "엑셀 업로드 → 차트 시각화" 라는 핵심 기능과 직접적으로 관련 없는 기능은 구현하지 않습니다. 확장성은 문서로만 고려합니다.
-   **오버엔지니어링 금지 (No Over-engineering):** 대용량 트래픽, 완벽한 보안 등 MVP 범위를 넘어서는 최적화 작업을 진행하지 않습니다.
-   **일관성 (Consistency):** 여기서 정의한 아키텍처, 코드 스타일, 커밋 규칙을 따라 프로젝트 전체의 일관성을 유지합니다.

---

## 2. 아키텍처 규칙 (Architecture Rules)

프로젝트는 `2.code-struture.md`에 정의된 구조를 엄격히 따릅니다.

-   **앱 분리:** 기능에 따라 `ingest`(데이터 입력) 앱과 `dashboard`(데이터 출력) 앱으로 명확히 분리합니다.
-   **로직 분리 (Fat Service, Skinny View):**
    -   `views.py`: 요청 파라미터 검증, 서비스 호출, 템플릿/JSON 응답 등 Presentation 역할만 수행합니다.
    -   `services.py`: `pandas` 파싱, ORM 조회/처리 등 핵심 비즈니스 로직을 이 파일에 집중시킵니다.
-   **종속성 분리:** 외부 라이브러리(e.g., Chart.js)에 특화된 데이터 변환 로직은 `utils/chart_adapter.py`와 같은 별도 유틸리티 파일로 분리하여 관리합니다.
-   **불필요한 레이어 금지:** MVP 범위에 맞지 않는 Repository, Interface 등 추가적인 디자인 패턴을 적용하지 않습니다.

---

## 3. 코드 스타일 가이드 (Code Style Guide)

-   **명명 규칙:** 변수, 함수, 클래스명은 Django 및 PEP 8 컨벤션(snake_case, PascalCase)을 따르며, 그 역할이 명확히 드러나도록 작성합니다.
-   **함수 작성:** 함수는 가능한 짧게, 하나의 기능만 수행하도록 작성합니다. (단일 책임 원칙)
-   **ORM 사용:** 모든 DB 쿼리는 `services.py` 내에서 ORM을 통해 수행하는 것을 원칙으로 합니다. View에서 ORM을 직접 호출하지 않습니다.
-   **주석:** "무엇을" 하는 코드인지 설명하는 주석은 지양하고, "왜" 이렇게 작성했는지 설명이 필요할 때만 간결하게 작성합니다.

---

## 4. 데이터베이스 관리 (Database Management)

데이터베이스 스키마의 모든 변경은 Django Migration 시스템을 통해 추적하고 관리합니다.

-   **ORM 우선:** DB 스키마 변경은 `models.py` 파일을 수정하고, `python manage.py makemigrations` 명령어로 마이그레이션 파일을 생성하는 것을 원칙으로 합니다.
-   **Supabase 직접 수정 금지:** Supabase 대시보드에서 테이블을 직접 수정하거나 Raw SQL을 실행하지 않습니다.
-   **공통 필드:** 모든 모델에는 생성/수정 시각을 자동으로 기록하기 위해 `created_at` (`auto_now_add=True`)과 `updated_at` (`auto_now=True`) 필드를 포함합니다.

---

## 5. 커밋 및 버전 관리 (Commit & Version Control)

-   **커밋 메시지:** [Conventional Commits](https://www.conventionalcommits.org/ko/v1.0.0/) 양식을 따릅니다.
    -   `feat`: 새로운 기능 추가
    -   `fix`: 버그 수정
    -   `docs`: 문서 수정
    -   `style`: 코드 포맷팅, 세미콜론 누락 등 (코드 변경 없는 경우)
    -   `refactor`: 코드 리팩토링
    -   `test`: 테스트 코드 추가/수정
-   **커밋 단위:** 하나의 커밋은 논리적으로 관련된 하나의 작업 단위만 포함해야 합니다.
-   **브랜치 (권장):** `main` 브랜치에 직접 커밋하는 대신, `feature/기능명` 브랜치를 생성하여 작업하고 Pull Request를 통해 병합하는 것을 권장합니다.
</file>

<file path="persona.md">
당신의 역할:
YC 배치 선정된 스타트업 CTO

당신의 목표:
- MVP 프로젝트를 최대한 빨리 완성하여, 첫번째 프로토타입을 내부 베타테스트한다.

당신이 추구하는 가치:
- 신속한 개발 iteration을 위해 간결하면서도 확장성 있는 구조를 추구한다.
- 오버엔지니어링을 피해 당장 해야만하는 작업만 수행한다.
- 가장 쉬운 인프라를 지향한다.

당신이 추구하지 않는 가치:
- 매우 높은 트래픽에서도 작동하도록 최적화한다.
- 모든 보안 취약점을 제거한다.
</file>

<file path="requirement.md">
* 사용자는 **1년차 개발자 수준의 기능 구현 연습**을 진행 중이다.
* 프로젝트 주제는 **“대학교 내부용 데이터 시각화 대시보드”**이며,
  핵심 목표는 **엑셀(Ecount 추출 데이터) → 파싱 → DB 저장 → 차트 시각화**의 전체 흐름 구현이다.
* **최소 복잡도와 유지보수 용이성**을 우선으로 하며, **확장성은 문서로만 고려**한다.
* 인증은 **Django 기본 세션 인증만 사용**, Supabase는 **PostgreSQL 호스팅용으로만 사용**한다.
* **Chart.js**를 사용하여 막대/라인/파이 차트를 한 페이지에서 렌더링하며,
  `/api/dashboard/chart-data/`는 **Chart.js 포맷(JSON)** 으로 응답한다.
* **엑셀 파싱은 pandas**로 수행하며, 필수 컬럼 검증·타입 캐스팅·에러 로깅 등 **방어적 파싱**을 적용한다.
* 현재는 **동기 처리(MVP)** 구조지만, 기술 부채로서 **비동기(Celery)** 전환 가능성을 문서화한다.
* UI는 Django Template 기반, 배포는 선택적으로 Railway를 사용한다.

**사용 기술 스택**
`Django 5.x + DRF + pandas + Chart.js + Supabase(Postgres only) + Railway(optional)`
</file>

<file path="settings.md">
# 프로젝트 초기 설정 가이드

이 문서는 Vibe Mafia 대시보드 프로젝트를 로컬 환경에서 설정하고 실행하기 위한 가이드입니다.

## 1. 사전 요구사항

-   **Python 3.10 이상**: [Python 공식 웹사이트](https://www.python.org/downloads/)에서 설치할 수 있습니다.
-   **Git**: [Git 공식 웹사이트](https://git-scm.com/downloads/)에서 설치할 수 있습니다.

## 2. 설정 절차

### 1단계: 소스 코드 복제 (Clone)

먼저, Git을 사용하여 프로젝트 소스 코드를 로컬 컴퓨터로 복제합니다.

```bash
git clone https://github.com/your-repository/vibe-mafia-dashboard.git
cd vibe-mafia-dashboard
```

### 2단계: 가상 환경 생성 및 활성화

프로젝트의 의존성을 독립적으로 관리하기 위해 가상 환경을 생성하고 활성화합니다.

**Windows:**

```bash
python -m venv venv
.\venv\Scripts\activate
```

**macOS / Linux:**

```bash
python3 -m venv venv
source venv/bin/activate
```

### 3단계: 의존성 설치

`requirements.txt` 파일을 사용하여 프로젝트에 필요한 모든 Python 패키지를 설치합니다.

```bash
pip install -r requirements.txt
```

### 4단계: 데이터베이스 마이그레이션

Django 모델을 기반으로 데이터베이스 스키마를 생성합니다.

```bash
python manage.py migrate
```

### 5단계: 관리자 계정 생성

Django Admin 및 대시보드에 로그인하기 위한 관리자(superuser) 계정을 생성합니다.

```bash
python manage.py createsuperuser
```

화면에 표시되는 안내에 따라 사용자 이름, 이메일, 비밀번호를 입력하세요.

### 6단계: 개발 서버 실행

모든 설정이 완료되었습니다. 아래 명령어를 실행하여 Django 개발 서버를 시작합니다.

```bash
python manage.py runserver
```

서버가 정상적으로 실행되면, 웹 브라우저에서 `http://127.0.0.1:8000/` 주소로 접속하여 대시보드를 확인할 수 있습니다.

-   **대시보드 접속**: `http://127.0.0.1:8000/dashboard/`
-   **로그인 페이지**: `http://127.0.0.1:8000/login/`
-   **관리자 페이지**: `http://127.0.0.1:8000/admin/`
</file>

<file path="test-plan.md">
pip install -r requirements-dev.txt && pytest -v
</file>

</files>
